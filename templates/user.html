<!DOCTYPE html>
<html lang="{{ 'ar' if language == 'ar' else 'en' }}" {{ 'dir="rtl"' if language == 'ar' else '' }} class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Profile - Teacher's Lesson Planner</title>
    <!-- Primary Meta Tags -->
    <meta name="description" content="Manage your Teacher's Lesson Planner account. Update your profile, change password, and manage your preferences.">
    <meta name="keywords" content="user profile, account settings, teacher account, profile management">
    <meta name="author" content="Eslam120">
    <meta name="robots" content="noindex, nofollow">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="{{ request.url }}">
    <meta property="og:title" content="My Profile - Teacher's Lesson Planner">
    <meta property="og:description" content="Manage your account settings and preferences">
    <meta property="og:image" content="{{ url_for('static', filename='generated-icon.png', _external=True) }}">
    <meta property="og:site_name" content="Teacher's Lesson Planner">
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="{{ request.url }}">
    <meta name="twitter:title" content="My Profile - Teacher's Lesson Planner">
    <meta name="twitter:description" content="Manage your account settings and preferences">
    <meta name="twitter:image" content="{{ url_for('static', filename='generated-icon.png', _external=True) }}">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='generated-icon.png') }}">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
</head>
<body class="bg-gray-900 text-gray-100 min-h-screen">
    
    {% include "navbar.html" %}


    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <div class="max-w-3xl mx-auto">
            <div class="bg-gray-800 rounded-lg shadow-2xl border border-gray-700 overflow-hidden">
                <!-- Card Header -->
                <div class="bg-indigo-600 px-6 py-4">
                    <h4 class="text-2xl font-bold text-white">
                        {% if language == 'ar' %}الملف الشخصي{% else %}User Profile{% endif %}
                    </h4>
                </div>
                
                <!-- Card Body -->
                <div class="p-8">
                    <!-- Flash Messages -->
                    {% with messages = get_flashed_messages() %}
                        {% if messages %}
                            <div class="bg-blue-500/20 border border-blue-500 text-blue-200 px-4 py-3 rounded-lg mb-6">
                                {% for message in messages %}
                                    {{ message }}
                                {% endfor %}
                            </div>
                        {% endif %}
                    {% endwith %}

                    <form method="POST" action="{{ url_for('routes.user') }}">
                        {{ form.hidden_tag() }}

                        <!-- Name Field -->
                        <div class="mb-6">
                            <label for="name" class="block text-sm font-semibold text-gray-200 mb-2">
                                {% if language == 'ar' %}الاسم{% else %}Name{% endif %}
                            </label>
                            {{ form.name(class="w-full bg-gray-700 border border-gray-600 text-white rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent", id="name") }}
                            {% if form.name.errors %}
                                <div class="text-red-400 text-sm mt-2">
                                    {% for error in form.name.errors %}
                                        {{ error }}
                                    {% endfor %}
                                </div>
                            {% endif %}
                        </div>

                        <!-- Email Field -->
                        <div class="mb-6">
                            <label for="email" class="block text-sm font-semibold text-gray-200 mb-2">
                                {% if language == 'ar' %}البريد الإلكتروني{% else %}Email{% endif %}
                            </label>
                            {{ form.email(class="w-full bg-gray-700 border border-gray-600 text-white rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent", id="email") }}
                            {% if form.email.errors %}
                                <div class="text-red-400 text-sm mt-2">
                                    {% for error in form.email.errors %}
                                        {{ error }}
                                    {% endfor %}
                                </div>
                            {% endif %}
                        </div>

                        <!-- Current Password Field -->
                        <div class="mb-6">
                            <label for="current_password" class="block text-sm font-semibold text-gray-200 mb-2">
                                {% if language == 'ar' %}كلمة المرور الحالية{% else %}Current Password{% endif %}
                            </label>
                            {{ form.current_password(class="w-full bg-gray-700 border border-gray-600 text-white rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent", id="current_password") }}
                            {% if form.current_password.errors %}
                                <div class="text-red-400 text-sm mt-2">
                                    {% for error in form.current_password.errors %}
                                        {{ error }}
                                    {% endfor %}
                                </div>
                            {% endif %}
                            <p class="text-gray-400 text-sm mt-2">
                                {% if language == 'ar' %}مطلوب لتأكيد التغييرات{% else %}Required to confirm changes{% endif %}
                            </p>
                        </div>

                        <!-- New Password Field -->
                        <div class="mb-6">
                            <label for="new_password" class="block text-sm font-semibold text-gray-200 mb-2">
                                {% if language == 'ar' %}كلمة المرور الجديدة{% else %}New Password{% endif %}
                            </label>
                            {{ form.new_password(class="w-full bg-gray-700 border border-gray-600 text-white rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent", id="new_password") }}
                            {% if form.new_password.errors %}
                                <div class="text-red-400 text-sm mt-2">
                                    {% for error in form.new_password.errors %}
                                        {{ error }}
                                    {% endfor %}
                                </div>
                            {% endif %}
                            <p class="text-gray-400 text-sm mt-2">
                                {% if language == 'ar' %}اتركها فارغة إذا كنت لا ترغب في تغيير كلمة المرور{% else %}Leave empty if you don't want to change your password{% endif %}
                            </p>
                        </div>

                        <!-- Confirm Password Field -->
                        <div class="mb-8">
                            <label for="confirm_password" class="block text-sm font-semibold text-gray-200 mb-2">
                                {% if language == 'ar' %}تأكيد كلمة المرور{% else %}Confirm Password{% endif %}
                            </label>
                            {{ form.confirm_password(class="w-full bg-gray-700 border border-gray-600 text-white rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent", id="confirm_password") }}
                            {% if form.confirm_password.errors %}
                                <div class="text-red-400 text-sm mt-2">
                                    {% for error in form.confirm_password.errors %}
                                        {{ error }}
                                    {% endfor %}
                                </div>
                            {% endif %}
                        </div>

                        <!-- Submit Button -->
                        <div class="mb-8">
                            {{ form.submit(class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-medium py-3 rounded-lg transition duration-300 cursor-pointer") }}
                        </div>
                    </form>

                    <!-- Divider -->
                    <div class="border-t border-gray-700 my-8"></div>

                    <!-- Delete Account Section -->
                    <div class="bg-red-500/10 border border-red-500 rounded-lg p-6">
                        <h5 class="text-xl font-bold text-red-400 mb-3">
                            {% if language == 'ar' %}حذف الحساب{% else %}Delete Account{% endif %}
                        </h5>
                        <p class="text-gray-300 mb-4">
                            {% if language == 'ar' %}
                                تحذير: هذا الإجراء لا يمكن التراجع عنه. سيتم حذف جميع دروسك وبياناتك نهائيًا.
                            {% else %}
                                Warning: This action cannot be undone. All your lessons and data will be permanently deleted.
                            {% endif %}
                        </p>
                        <button 
                            type="button" 
                            onclick="openDeleteModal()"
                            class="bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-6 rounded-lg transition duration-300"
                        >
                            {% if language == 'ar' %}حذف حسابي{% else %}Delete My Account{% endif %}
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Delete Account Modal -->
    <div id="deleteAccountModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4 border border-gray-700">
            <!-- Modal Header -->
            <div class="flex justify-between items-center p-6 border-b border-gray-700">
                <h5 class="text-xl font-bold text-white">
                    {% if language == 'ar' %}تأكيد حذف الحساب{% else %}Confirm Account Deletion{% endif %}
                </h5>
                <button 
                    onclick="closeDeleteModal()" 
                    class="text-gray-400 hover:text-white transition"
                >
                    <i class="bi bi-x-lg text-xl"></i>
                </button>
            </div>
            
            <!-- Modal Body -->
            <div class="p-6">
                <p class="text-gray-300">
                    {% if language == 'ar' %}
                        هل أنت متأكد أنك تريد حذف حسابك؟ هذا الإجراء لا يمكن التراجع عنه.
                    {% else %}
                        Are you sure you want to delete your account? This action cannot be undone.
                    {% endif %}
                </p>
            </div>
            
            <!-- Modal Footer -->
            <div class="flex justify-end gap-3 p-6 border-t border-gray-700">
                <button 
                    onclick="closeDeleteModal()" 
                    class="bg-gray-600 hover:bg-gray-700 text-white font-medium py-2 px-6 rounded-lg transition"
                >
                    {% if language == 'ar' %}إلغاء{% else %}Cancel{% endif %}
                </button>
                <form action="{{ url_for('routes.delete_account') }}" method="POST" class="inline">
                    <button 
                        type="submit" 
                        class="bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-6 rounded-lg transition"
                    >
                        {% if language == 'ar' %}نعم، احذف حسابي{% else %}Yes, Delete My Account{% endif %}
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- Footer -->
     {% include "footer.html" %}


    <!-- JavaScript for Modal -->
    <script>
        function openDeleteModal() {
            document.getElementById('deleteAccountModal').classList.remove('hidden');
            document.getElementById('deleteAccountModal').classList.add('flex');
        }
        
        function closeDeleteModal() {
            document.getElementById('deleteAccountModal').classList.add('hidden');
            document.getElementById('deleteAccountModal').classList.remove('flex');
        }
        
        // Close modal when clicking outside
        document.getElementById('deleteAccountModal').addEventListener('click', function(event) {
            if (event.target === this) {
                closeDeleteModal();
            }
        });
    </script>

</body>
</html>